# üìã HR System API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üöÄ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏ –∏ –∏—Å—Ç–æ—Ä–∏–µ–π –¥–µ–π—Å—Ç–≤–∏–π.

### –ë–∞–∑–æ–≤—ã–π URL
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ: `http://localhost:3000`
- –ü—Ä–æ–¥–∞–∫—à–Ω: `https://your-domain.com`

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
Authorization: Bearer <your_jwt_token>
```

## üë• –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- **admin** - –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –æ–ø–µ—Ä–∞—Ü–∏—è–º
- **editor** - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- **user** - –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### POST /login
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "admin",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "user": {
    "id": 1,
    "username": "admin",
    "role": "admin"
  }
}
```

### POST /register
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "newuser",
  "password": "securePassword123",
  "role": "user",
  "specialPassword": "admin-secret" // –¢–æ–ª—å–∫–æ –¥–ª—è admin/editor —Ä–æ–ª–µ–π
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω",
  "user": {
    "id": 4,
    "username": "newuser",
    "role": "user"
  }
}
```

### GET /me
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (—Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é)

### GET /verify
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é)

## üë®‚Äçüíº –†–∞–±–æ—Ç–Ω–∏–∫–∏

### GET /workers
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": [
    {
      "id": 21,
      "name": "–ò–≤–∞–Ω",
      "fam": "–ò–≤–∞–Ω–æ–≤",
      "otch": "–ò–≤–∞–Ω–æ–≤–∏—á",
      "gender_id": 1,
      "gender_name": "–ú",
      "prof_id": 1,
      "prof_name": "–ò–Ω–∂–µ–Ω–µ—Ä",
      "position_id": 30,
      "position_name": "–ò–Ω–∂–µ–Ω–µ—Ä-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä",
      "salary": 80000,
      "education_id": 2,
      "education_name": "–í—ã—Å—à–µ–µ",
      "date_r": "1985-02-15",
      "date_hired": "2010-05-01",
      "date_fired": null
    }
  ],
  "count": 8
}
```

### GET /workers/:id
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞

### POST /workers
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "name": "–ê–Ω–Ω–∞",
  "fam": "–ü–µ—Ç—Ä–æ–≤–∞",
  "otch": "–°–µ—Ä–≥–µ–µ–≤–Ω–∞",
  "gender_id": 2,
  "prof_id": 6,
  "position_id": 27,
  "salary": 75000,
  "education_id": 2,
  "date_r": "1985-03-28",
  "date_hired": "2012-01-15"
}
```

### PUT /workers/:id
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

### DELETE /workers/:id
–£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

### GET /workers/count
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

–í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É API:

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏:
- `/api/positions` - –î–æ–ª–∂–Ω–æ—Å—Ç–∏
- `/api/professions` - –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏
- `/api/education` - –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- `/api/genders` - –ü–æ–ª
- `/api/actions` - –î–µ–π—Å—Ç–≤–∏—è (–ø—Ä–µ–º–∏–∏/—à—Ç—Ä–∞—Ñ—ã)

### GET /api/{reference}
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

### GET /api/{reference}/:id
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏

### POST /api/{reference}
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "name": "–ù–æ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å"
}
```

### PUT /api/{reference}/:id
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

### DELETE /api/{reference}/:id
–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å admin)

### GET /api/{reference}/count
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π

## üìú –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π

### GET /list
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π (–ø—Ä–µ–º–∏–∏/—à—Ç—Ä–∞—Ñ—ã)

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "workers_id": 21,
      "actions_id": 1,
      "sum": 5000,
      "date": "2021-06-09",
      "worker_name": "–ò–≤–∞–Ω",
      "worker_fam": "–ò–≤–∞–Ω–æ–≤",
      "worker_otch": "–ò–≤–∞–Ω–æ–≤–∏—á",
      "worker_full_name": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
      "action_name": "–ü—Ä–µ–º–∏—è"
    }
  ],
  "count": 9
}
```

### GET /list/:id
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏—Å—Ç–æ—Ä–∏–∏

### POST /list
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏—Å—Ç–æ—Ä–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "workers_id": 21,
  "actions_id": 1,
  "sum": 5000,
  "date": "2024-01-15"
}
```

### PUT /list/:id
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏—Å—Ç–æ—Ä–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

### DELETE /list/:id
–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏—Å—Ç–æ—Ä–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å editor –∏–ª–∏ admin)

### GET /list/count
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### GET /workers/count
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤

### GET /api/positions/count
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π

### GET /api/professions/count
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π

### GET /list/count
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏

## ‚ùå –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### –û–±—â–∏–µ –æ—à–∏–±–∫–∏:
- `TOKEN_MISSING` - –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- `TOKEN_INVALID` - –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
- `USER_NOT_AUTHENTICATED` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- `INSUFFICIENT_PERMISSIONS` - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
- `VALIDATION_ERROR` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- `INTERNAL_ERROR` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:
- `INVALID_CREDENTIALS` - –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `USER_ALREADY_EXISTS` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `WORKER_NOT_FOUND` - –†–∞–±–æ—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω
- `RECORD_NOT_FOUND` - –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `DUPLICATE_NAME` - –ó–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `FOREIGN_KEY_CONSTRAINT` - –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

## üîí Rate Limiting

API –∑–∞—â–∏—â–µ–Ω–æ –æ—Ç spam-–∞—Ç–∞–∫:
- –ú–∞–∫—Å–∏–º—É–º 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 15 –º–∏–Ω—É—Ç –¥–ª—è `/api/`, `/login`, `/register`
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ IP –∞–¥—Ä–µ—Å—É

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt
- JWT —Ç–æ–∫–µ–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- Helmet.js –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö security –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Rate limiting

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥–∏:
- HTTP –∑–∞–ø—Ä–æ—Å—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º –æ—Ç–≤–µ—Ç–∞
- –û–ø–µ—Ä–∞—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –û—à–∏–±–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `/logs/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
- `app-YYYY-MM-DD.log` - –æ–±—â–∏–µ –ª–æ–≥–∏
- `error-YYYY-MM-DD.log` - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏

## üê≥ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ Docker:
```bash
docker-compose up -d
```

### –õ–æ–∫–∞–ª—å–Ω–æ:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env

# –ó–∞–ø—É—Å–∫
npm start
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–º. —Ñ–∞–π–ª `.env.example` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.